---
# Copyright Vespa.ai. All rights reserved.
title: Testing with Java JUnit tests
---

<p>
  This is the Vespa Testing reference for <a href="../testing.html">Vespa application system tests</a>
  written in Java, as JUnit 5 unit test.
</p>
<p>
  These tests verify the behaviour of a Vespa application by using its HTTP interfaces.
  To write tests without Java, see <a href="testing.html">basic HTTP test reference</a>.
</p>
<p>See the <a href="../testing.html">testing guide</a> for examples of how to run the tests.</p>



<h2 id="test-suites">Test suites</h2>
<p>
  The <a href="../testing.html">testing documentation</a> defines three test scenarios,
  comprised of four test code categories. The <em>system test framework</em> in
  <a href="https://search.maven.org/artifact/com.yahoo.vespa/tenant-cd-api">com.yahoo.vespa:tenant-cd-api</a>
  uses Java annotations to declare what category a JUnit test class belongs to.
  To run tests with Maven belonging to a specific category, a JUnit 5 test <em>tag</em> must be specified:
</p>
<pre>{% highlight sh %}
$ mvn test -D test.categories=system -D vespa.test.config=/path-to/test-config.json
{% endhighlight %}</pre>
<table class="table">
  <thead>
  <tr>
    <th style="width:200px;font-weight:bold">Category</th>
    <th style="width:200px">Annotation</th>
    <th style="width:200px">JUnit tag</th>
    <th>Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td style="font-weight:bold">System test</td>
    <td>@SystemTest</td>
    <td>system</td>
    <td>Independent, functional tests</td>
  </tr><tr>
    <td style="font-weight:bold">Staging setup</td>
    <td>@StagingSetup</td>
    <td>staging-setup</td>
    <td>Set state before upgrade</td>
  </tr><tr>
    <td style="font-weight:bold">Staging test</td>
    <td>@StagingTest</td>
    <td>staging</td>
    <td>Verify state after upgrade</td>
  </tr><tr>
    <td style="font-weight:bold">Production test</td>
    <td>@ProductionTest</td>
    <td>production</td>
    <td>Verify domain specific metrics</td>
  </tr>
</table>
<p>
  For an example including system and staging tests, check out the
  <a href="https://github.com/vespa-cloud/examples/tree/main/CI-CD/production-deployment-with-tests-java">
  sample application test suite</a>.
</p>

<h2 id="testng">TestNG</h2>
<p>
  Combining Vespa JUnit 5 test suites with unit tests in TestNG is possible. You'll need to explicitly configure
  Maven's surefire plugin to enable integration for both frameworks. To execute the Vespa test suites specify
  <code>-D test.categories=[tag]</code>, where <em>[tag]</em> is one of the values listed in <a href="#test-suites">Test suites</a>.
</p>
<pre>{% highlight xml %}
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <dependencies>
        <dependency>
            <groupId>org.apache.maven.surefire</groupId>
            <artifactId>surefire-junit-platform</artifactId>
            <version>${surefire.vespa.tenant.version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.maven.surefire</groupId>
            <artifactId>surefire-testng</artifactId>
            <version>${surefire.vespa.tenant.version}</version>
        </dependency>
    </dependencies>
</plugin>
{% endhighlight %}</pre>
